<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: js/pages/home.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: js/pages/home.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// Import functions to initialize and display recipes
import { init, displayFilteredRecipes } from '../../display.js';

/**
 *  Main exported function to render mobile-friendly filters and actions
 */
export default function () {
    requestAnimationFrame(() => {
        init();
    });

    // Mobile search and icon row
    const headerSearch = document.querySelector('.top-nav .search-bar');
    const searchClone = headerSearch.cloneNode(true);

    // Create a mobile-specific search/action container
    const mobileSearchActions = document.createElement('div');
    mobileSearchActions.className = 'mobile-search-actions';
    mobileSearchActions.appendChild(searchClone);

    // Create mobile action icons (shuffle, add)
    const mobileActions = document.createElement('div');
    mobileActions.className = 'mobile-actions';

    const shuffleIcon = document.createElement('button');
    shuffleIcon.id = 'shuffle-icon';
    shuffleIcon.textContent = 'ðŸ”€';

    const addIcon = document.createElement('button');
    addIcon.id = 'add-icon';
    addIcon.textContent = 'âž•';

    mobileActions.append(shuffleIcon, addIcon);
    mobileSearchActions.appendChild(mobileActions);

    // Insert mobile UI just below the header
    const siteHeader = document.querySelector('.site-header');
    siteHeader.insertAdjacentElement('afterend', mobileSearchActions);

    // Create filter navigation section
    const section = document.createElement('section');
    section.className = 'sub-nav';

    const filters = document.createElement('ul');
    filters.className = 'filters';

     // Add filter dropdowns
    const mealFilter = createFilter('filter1', 'Meal', [
        'Breakfast',
        'Lunch',
        'Dinner',
        'Dessert',
        'Snack',
        'Beverage',
    ]);
    const cuisineFilter = createFilter('filter2', 'Cuisine', [
        'African',
        'Asian',
        'European',
        'Latin American',
        'Middle Eastern',
        'North American',
    ]);
    const timeFilter = createFilter('filter3', 'Estimated Time', [
        'Under 30 minutes',
        'Under 1 Hour',
        'Over 1 Hour',
    ]);
    const ingredientsFilter = createIngredientFilter('filter4', 'Ingredients');

    filters.append(mealFilter, cuisineFilter, timeFilter, ingredientsFilter);
    section.append(filters);

    // Main content area for recipe cards
    const main = document.createElement('main');
    section.appendChild(main);

    const actions = document.createElement('div');
    actions.className = 'actions';
    
     // Action buttons (shuffle and add)
    const shuffleBtn = document.createElement('button');
    shuffleBtn.className = 'btn-shuffle';
    shuffleBtn.textContent = 'Shuffle';
    shuffleBtn.addEventListener('click', () => {
        // put shuffleing logic here
    });

    const addBtn = document.createElement('button');
    addBtn.className = 'btn-add';
    addBtn.textContent = 'Add Recipe Card';
    addBtn.addEventListener('click', () => {
        location.hash = '#/create';
    });

    actions.append(shuffleBtn, addBtn);
    section.append(actions);

    // mobile icons have same functionality as "normal" action buttons
    shuffleIcon.addEventListener('click', () => shuffleBtn.click());
    addIcon.addEventListener('click', () => addBtn.click());

    return section;
}

/**
 * Creates a dropdown filter based on an attribute of a recipe
 * @param {string} name - Name of the filter
 * @param {string} label - Type of filter
 * @param {Array} options - Options in filter
 * @returns {HTMLElement} - returns an HTMLElement containing a select tag for a filter
 */
function createFilter(name, label, options) {
    const li = document.createElement('li');
    const select = document.createElement('select');
    select.className = 'btn-filter';
    select.name = name;

    const defaultOption = document.createElement('option');
    defaultOption.disabled = false;
    defaultOption.selected = true;
    defaultOption.textContent = label;
    defaultOption.value = '';
    select.appendChild(defaultOption);

    for (const opt of options) {
        const option = document.createElement('option');
        option.textContent = opt;
        option.value = opt;
        select.appendChild(option);
    }

    li.appendChild(select);
    return li;
}

/**
 * Creates the ingredient dropdown filter with search bar
 * @param {string} name - Filter name
 * @param {string} label - Label of filter
 * @returns {HTMLElement} - returns an HTMLElement containing the ingredient filter with a search bar
 */
function createIngredientFilter(name, label) {
    const all = document.createElement('div');

    const ingredientFilterButton = document.createElement('button');
    ingredientFilterButton.className = 'btn-filter';
    ingredientFilterButton.textContent = label;
 

    const dropDown = document.createElement('div');
    dropDown.className = 'ingredient-dropdown';
    dropDown.style.display='none';

    const searchBar = document.createElement('input');
    searchBar.type = 'text';
    searchBar.placeholder = 'Search Ingredients';
    searchBar.className = 'ingredient-search-bar';

    //list of ingredients 
    const resultsContainer = document.createElement('ul');
    resultsContainer.className='ingredient-results-container';
    resultsContainer.style.listStyle = 'none'; 

    dropDown.appendChild(searchBar);
    dropDown.appendChild(resultsContainer);
    

    // prevent clicks inside dropdown from closing it
    dropDown.addEventListener('click', (e) => {
        e.stopPropagation();
    });


    // TODO: Toggle dropdown when the users click the button
    ingredientFilterButton.addEventListener('click', async function (event) {
        event.stopPropagation();

        if(dropDown.style.display ==='none'){
            
            dropDown.style.display='block';   

            const fromStorage= await getIngredients();

            resultsContainer.innerHTML='';


            for (const opt of fromStorage) {
                const option = document.createElement('li');
                option.textContent = opt;
                option.value=opt;
                option.style.cursor='pointer';
                option.style.padding='8px';
                option.addEventListener('click',() =>{
                    console.log('selected: ', opt);
                    displayFilteredRecipes(opt);
                    dropDown.style.display='none';
                });
                resultsContainer.appendChild(option);
            }

        }else{
            dropDown.style.display='none';
        }
    });

 

    searchBar.addEventListener('input', function (event) {
        renderResults(searchBar.value);
    });

    // TODO: render the ingredient results based on search
    function renderResults(searchTarget = '') {
        const searchValue = searchTarget.toLowerCase().trim();
        const items = resultsContainer.querySelectorAll('li');
        items.forEach((item) => {
            const text = item.textContent.toLowerCase();
            if (text.includes(searchValue)) {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        });
    }

    // TODO: handle the search
    searchBar.addEventListener('keypress', function (event) {
        if (event.key === 'Enter') {
            event.preventDefault();
            const searchValue = searchBar.value.toLowerCase().trim();
            if (searchValue) {
                displayFilteredRecipes(searchValue);
                dropDown.style.display = 'none';
            }
        }
    });

    /**
     * This is an asynchronous function which grabs all the recipes from localStorage to make a list of all unique ingredients
     * @returns {Array} - An Array of unique ingredients from all recipes in Local storage
     */
    async function getIngredients() {
        const recipeMetadata = localStorage.getItem('recipe_metadata');
        if (!recipeMetadata) {return [];}

        try {
            const recipes = JSON.parse(recipeMetadata);
            const uniqueIngredients = new Set();
            recipes.forEach((recipe) => {
                if (
                    recipe.recipeIngredient &amp;&amp;
                    Array.isArray(
                        recipe.recipeIngredient &amp;&amp; recipe.recipeIngredient
                    )
                ) {
                    recipe.recipeIngredient.forEach((ingredient) => {
                        if (
                            ingredient &amp;&amp;
                            ingredient.name &amp;&amp;
                            typeof ingredient.name === 'string' &amp;&amp;
                            ingredient.name.trim() !== ''
                        )
                        {uniqueIngredients.add(
                            ingredient.name.trim().toLowerCase()
                        );} // right now it will store as lowercases
                    });
                }
            });
            return Array.from(uniqueIngredients).sort();
        } catch (error) {
            console.error(
                'Error parsing recipe metadata for Ingredients filter',
                error
            );
            return [];
        }
    }

    // close dropdown on clicking anything outside of the box container
    document.addEventListener('click', () => {
        dropDown.style.display = 'none';
    });

    all.appendChild(ingredientFilterButton);
    all.appendChild(dropDown);
    return all;
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="RecipeCard.html">RecipeCard</a></li><li><a href="RecipeStore.html">RecipeStore</a></li></ul><h3>Global</h3><ul><li><a href="global.html#clearTimer">clearTimer</a></li><li><a href="global.html#createFilter">createFilter</a></li><li><a href="global.html#createIngredientFilter">createIngredientFilter</a></li><li><a href="global.html#displayFilteredRecipes">displayFilteredRecipes</a></li><li><a href="global.html#displayRecipes">displayRecipes</a></li><li><a href="global.html#filterMetadata">filterMetadata</a></li><li><a href="global.html#getAllMetadata">getAllMetadata</a></li><li><a href="global.html#getFromStorage">getFromStorage</a></li><li><a href="global.html#handleCreate">handleCreate</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#loadRecipeDetails">loadRecipeDetails</a></li><li><a href="global.html#render">render</a></li><li><a href="global.html#renderCardDetails">renderCardDetails</a></li><li><a href="global.html#startTimerFromInputs">startTimerFromInputs</a></li><li><a href="global.html#updateDisplay">updateDisplay</a></li><li><a href="global.html#updateTimerPreview">updateTimerPreview</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.11</a> on Sun Jun 08 2025 23:02:56 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
